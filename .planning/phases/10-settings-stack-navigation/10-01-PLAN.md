---
phase: 10-settings-stack-navigation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - app/settings/index.tsx
  - app/settings/_layout.tsx
  - app/index.tsx
  - src/components/SettingsSheet.tsx
  - package.json
autonomous: true

must_haves:
  truths:
    - "Tapping the settings gear icon navigates to a full-screen settings screen that slides from the right"
    - "Settings screen has a back button that returns to the dashboard"
    - "My Exercises, Workout History, and Workout Detail sub-screens continue to work as stack pushes from settings"
    - "@gorhom/bottom-sheet is no longer imported or used anywhere in the source code"
  artifacts:
    - path: "app/settings/index.tsx"
      provides: "Full-screen settings menu screen"
      min_lines: 40
    - path: "app/index.tsx"
      provides: "Dashboard without SettingsSheet references"
      contains: "router.push.*settings"
  key_links:
    - from: "app/index.tsx"
      to: "app/settings/index.tsx"
      via: "router.push('/settings') from DashboardHeader onSettingsPress callback"
      pattern: "router\\.push.*['\"/]settings['\"]"
    - from: "app/settings/index.tsx"
      to: "app/settings/exercises.tsx"
      via: "router.push('/settings/exercises')"
      pattern: "router\\.push.*settings/exercises"
    - from: "app/settings/index.tsx"
      to: "app/settings/history.tsx"
      via: "router.push('/settings/history')"
      pattern: "router\\.push.*settings/history"
---

<objective>
Replace the settings bottom sheet overlay with a full-screen settings screen using standard Expo Router stack navigation. Delete the SettingsSheet component and uninstall @gorhom/bottom-sheet.

Purpose: The bottom sheet overlay pattern for settings adds unnecessary complexity (dismiss-then-navigate with 200ms setTimeout, state management in dashboard, gesture conflict avoidance). A full-screen stack push is simpler, more native-feeling, and eliminates an external dependency.

Output: Settings accessible via full-screen stack navigation from the dashboard gear icon, with @gorhom/bottom-sheet fully removed from the project.
</objective>

<execution_context>
@C:\Users\MarioPC\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\MarioPC\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/10-settings-stack-navigation/10-RESEARCH.md

# Existing files being modified/replaced
@src/components/SettingsSheet.tsx
@app/index.tsx
@app/settings/_layout.tsx
@src/components/DashboardHeader.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create settings index screen</name>
  <files>app/settings/index.tsx, app/settings/_layout.tsx</files>
  <action>
Create `app/settings/index.tsx` as a full-screen settings menu screen. Port the menu UI from `src/components/SettingsSheet.tsx` into this screen:

**Settings index screen (`app/settings/index.tsx`):**
- SafeAreaView container with `theme.colors.bgPrimary` background
- Header row: back button (chevron-back icon, `router.back()`), "Settings" title text, spacer for alignment
- Menu items (same UI as SettingsSheet.tsx):
  - "My Exercises" with list-outline icon, chevron-forward, navigates via `router.push('/settings/exercises')`
  - "Workout History" with time-outline icon, chevron-forward, navigates via `router.push('/settings/history')`
  - Separator line (1px border color)
  - "Log Out" with log-out-outline icon in danger color, calls `auth.logout()`
- Use `getStyles(theme)` pattern with `StyleSheet.create()` (same pattern as every screen in the codebase)
- Import `auth` from `@/services/auth` for logout
- Import `useTheme` and `Theme` from `@/theme`
- Use Pressable with `pressed && styles.menuItemPressed` pattern for touch feedback (same as SettingsSheet)
- Menu items must have minHeight: 52 for 44px tap target compliance

**Settings layout (`app/settings/_layout.tsx`):**
- The existing layout already has `headerShown: false` for all screens, which is correct -- the settings index screen provides its own header. No changes needed unless the index screen's back navigation doesn't work correctly. If it does work correctly, leave _layout.tsx unchanged.

**Style tokens to use (from SettingsSheet.tsx):**
- `theme.colors.bgPrimary` for container background
- `theme.colors.bgElevated` for pressed state
- `theme.colors.textPrimary` for menu labels and icons
- `theme.colors.textMuted` for chevron-forward icons
- `theme.colors.danger` for logout icon and label
- `theme.colors.border` for separator
- `theme.spacing.md` for horizontal padding, `theme.spacing.sm` for vertical padding
- `theme.typography.sizes.base` for menu labels, `theme.typography.sizes.lg` for header title
- `theme.typography.weights.medium` for menu labels, `theme.typography.weights.semibold` for header title
  </action>
  <verify>
Run `npx tsc --noEmit` to verify TypeScript compiles without errors. The new file should import correctly and have no type issues.
  </verify>
  <done>
`app/settings/index.tsx` exists with a full-screen settings menu (back button, My Exercises, Workout History, Log Out). TypeScript compiles cleanly.
  </done>
</task>

<task type="auto">
  <name>Task 2: Rewire dashboard and remove bottom sheet dependency</name>
  <files>app/index.tsx, src/components/SettingsSheet.tsx, package.json</files>
  <action>
**Modify `app/index.tsx` (dashboard):**

Remove ALL SettingsSheet-related code:
1. Remove import: `import { SettingsSheet } from '@/components/SettingsSheet';`
2. Remove state: `const [settingsOpen, setSettingsOpen] = useState(false);`
3. Remove all handler functions: `handleSettingsPress`, `handleSettingsClose`, `handleMyExercises`, `handleWorkoutHistory`, `handleLogout`
4. Remove JSX: The entire `<SettingsSheet ... />` element
5. Replace: The `handleSettingsPress` function with a new one that simply does `router.push('/settings')`
6. The `DashboardHeader` already accepts `onSettingsPress` callback -- pass the new function

Also remove the `auth` import from dashboard since logout is now handled by the settings screen:
- Remove: `import { auth } from '@/services/auth';`

**Verify the dashboard still has these imports (do NOT remove):**
- `useRouter` (still needed for template editor, workout, etc.)
- `useState` (still needed for resumeData, showResumeModal, showAddChart)
- All other imports unrelated to SettingsSheet

**Delete `src/components/SettingsSheet.tsx`:**
- Delete the entire file. It is no longer used anywhere.

**Uninstall @gorhom/bottom-sheet:**
- Run `pnpm remove @gorhom/bottom-sheet`
- This will update package.json and pnpm-lock.yaml

**Post-cleanup verification:**
- Grep the entire `src/` and `app/` directories for any remaining references to `SettingsSheet` or `@gorhom/bottom-sheet` in source code (not comments, not planning docs)
- If AddChartSheet.tsx has a comment mentioning @gorhom/bottom-sheet (it does -- "NOT @gorhom/bottom-sheet"), that is fine since it's just a comment, not an import
  </action>
  <verify>
1. Run `npx tsc --noEmit` -- TypeScript compiles with no errors
2. Run `grep -r "SettingsSheet" src/ app/` -- no results (file deleted, import removed)
3. Run `grep -r "from '@gorhom/bottom-sheet'" src/ app/` -- no results (no source imports)
4. Run `grep "@gorhom/bottom-sheet" package.json` -- no results (dependency removed)
5. Run `pnpm install` -- lockfile is consistent
  </verify>
  <done>
Dashboard gear icon navigates to `/settings` via `router.push`. SettingsSheet.tsx is deleted. @gorhom/bottom-sheet is uninstalled from package.json. No source files import the removed dependency. TypeScript compiles cleanly.
  </done>
</task>

</tasks>

<verification>
1. `npx tsc --noEmit` passes -- no TypeScript errors in the entire project
2. No source file in `src/` or `app/` imports `@gorhom/bottom-sheet`
3. No source file in `src/` or `app/` imports `SettingsSheet`
4. `app/settings/index.tsx` exists and exports a default screen component
5. `app/index.tsx` has `router.push('/settings')` in its settings press handler
6. `package.json` does not contain `@gorhom/bottom-sheet`
</verification>

<success_criteria>
- Gear icon tap on dashboard navigates to full-screen settings screen (stack push, slides from right)
- Settings screen shows back button, My Exercises, Workout History, and Log Out menu items
- Back button returns to dashboard
- My Exercises navigates to /settings/exercises (existing screen, unchanged)
- Workout History navigates to /settings/history (existing screen, unchanged)
- Log Out calls auth.logout()
- @gorhom/bottom-sheet is fully removed from the project
- SettingsSheet.tsx file no longer exists
</success_criteria>

<output>
After completion, create `.planning/phases/10-settings-stack-navigation/10-01-SUMMARY.md`
</output>
